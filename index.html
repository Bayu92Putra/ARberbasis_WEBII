
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>WebAR Hiro - Shader Inline</title>
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://cdn.rawgit.com/jeromeetienne/ar.js/2.2.1/aframe/build/aframe-ar.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    html, body {
      margin: 0;
      overflow: hidden;
      background-color: transparent;
    }
    #uiContainer {
      width: 1024px;
      height: 768px;
      background: transparent;
    }
  </style>
</head>
<body>

<!-- HTML shader inline script -->
<script>
AFRAME.registerShader('html', {
  schema: {
    target: { type: 'selector' },
    width: { type: 'int', default: 512 },
    height: { type: 'int', default: 512 }
  },
  init: function (data) {
    this.canvas = document.createElement('canvas');
    this.canvas.width = data.width;
    this.canvas.height = data.height;
    this.ctx = this.canvas.getContext('2d');
    this.texture = new THREE.Texture(this.canvas);
    this.el.sceneEl.object3D.onBeforeRender = () => this.update();
  },
  update: function () {
    if (!this.data.target) return;
    this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
    this.ctx.drawImage(this.data.target, 0, 0, this.canvas.width, this.canvas.height);
    this.texture.needsUpdate = true;
  },
  tick: function () {
    this.update();
  },
  getMaterial: function () {
    return new THREE.MeshBasicMaterial({ map: this.texture, transparent: true });
  }
});
</script>

<!-- UI Container -->
<div id="uiContainer" style="position: absolute; top: -9999px; left: -9999px;">
  <div class="flex flex-col md:flex-row max-w-7xl mx-auto w-full p-6 text-white bg-gray-800/80 rounded-xl shadow-xl">
    <div class="md:w-1/2 space-y-6">
      <video id="mainVideo" class="w-full rounded-xl" controls preload="metadata">
        <source src="https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.mp4" type="video/mp4" />
      </video>
      <div class="flex justify-end space-x-3">
        <button onclick="document.getElementById('mainVideo').play()" class="bg-blue-600 px-4 py-1 rounded">Play</button>
        <button onclick="document.getElementById('mainVideo').pause()" class="bg-red-600 px-4 py-1 rounded">Pause</button>
      </div>
      <div class="grid grid-cols-2 gap-4">
        <div class="bg-gray-900/90 p-4 rounded">
          <audio controls src="https://interactive-examples.mdn.mozilla.net/media/examples/t-rex-roar.mp3" class="w-full"></audio>
          <p class="text-sm mt-2">Audio 1 - Description</p>
        </div>
        <div class="bg-gray-900/90 p-4 rounded">
          <audio controls src="https://interactive-examples.mdn.mozilla.net/media/examples/t-rex-roar.mp3" class="w-full"></audio>
          <p class="text-sm mt-2">Audio 2 - History</p>
        </div>
      </div>
    </div>
    <div class="md:w-1/2 p-4 bg-gray-700/80 rounded-xl overflow-y-auto max-h-[500px]">
      <h2 class="text-2xl font-bold mb-3">Object Explanation</h2>
      <p class="mb-3">Mona Lisa adalah lukisan paling terkenal karya Leonardo da Vinci...</p>
      <p class="mb-3">Teknik sfumato menciptakan kesan lembut dan realistis...</p>
      <p>Dipamerkan di Louvre, lukisan ini menarik jutaan pengunjung setiap tahun.</p>
    </div>
  </div>
</div>

<!-- AR Scene -->
<a-scene embedded arjs="sourceType: webcam;" renderer="alpha: true" vr-mode-ui="enabled: false">
  <a-marker preset="hiro" id="markerHiro">
    <a-entity id="htmlEntity"
              geometry="primitive: plane; height: 2.2; width: 3"
              material="shader: html; target: #uiContainer"
              position="0 0 0" rotation="-90 0 0"
              visible="false">
    </a-entity>
  </a-marker>
  <a-entity camera></a-entity>
</a-scene>

<script>
  const marker = document.querySelector('#markerHiro');
  const htmlEntity = document.querySelector('#htmlEntity');

  marker.addEventListener('markerFound', () => {
    htmlEntity.setAttribute('visible', 'true');
  });

  marker.addEventListener('markerLost', () => {
    htmlEntity.setAttribute('visible', 'false');
  });
</script>

</body>
</html>
